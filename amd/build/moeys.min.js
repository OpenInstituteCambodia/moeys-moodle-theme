define(["jquery","core/log"],function(a,b){"use strict";return b.debug("MoEYS AMD"),{init:function(){function c(){b.debug("MoEYS AMD init"),window.MoEYS=d,d.init(),b.debug(d)}const d={theme:M.cfg.theme,basedir:"",request:null,data:{"default":{province_id:"",district_id:"",school_id:""},options:{provinces:[],districts:[],school_types:[],schools:[]},selectors:{province:a("#id_profile_field_school_province_id"),district:a("#id_profile_field_school_district_id"),school:a("#id_profile_field_school_id")}},init:function(){this.createInstance(),this.setupFormWatcher(),console.log("MoEYS Script init")},ajax:function(a,b){return b=b||{},this.request(a,b)},createInstance:function(){this.basedir="/theme/jquery.php/theme_"+this.theme+"/moeys/json/",this.request=axios.create({baseURL:this.basedir})},setupFormWatcher:function(){var a=this;this.data["default"].province_id=this.data.selectors.province.val(),this.data["default"].district_id=this.data.selectors.district.val(),this.data["default"].school_id=this.data.selectors.school.val(),this.createProvinceSelect(),this.data.selectors.province.on("change",function(b){a.onProvinceChangeHandler.call(a,b)}),this.data.selectors.district.on("change",function(b){a.onDistrictChangeHandler.call(a,b)}),console.group("MoEYS"),b.debug(this.data["default"].province_id,"default_province_id"),b.debug(this.data["default"].district_id,"default_district_id"),b.debug(this.data["default"].school_id,"default_school_id"),console.groupEnd()},createSelectOptions:function(b){var c=[a("<option>").val("").text("Choose an option")];return b.forEach(function(b){var d=a("<option>").val(b.id).text(b.name_km);c.push(d)}),c},createProvinceSelect:function(){if(0!==this.data.selectors.province.length){var a=this;this.ajax("provinces.json").then(function(b){a.data.options.provinces=b.data;var c=a.createSelectOptions(b.data);a.data.selectors.province[0].options.length=0,a.data.selectors.province.append(c),a.data.selectors.province.val(a.data["default"].province_id).trigger("change")}),this.ajax("districts.json").then(function(b){a.data.options.districts=b.data})}},onProvinceChangeHandler:function(c){var d=a(c.target).val();this.data.selectors.district.val(""),this.data.selectors.school.val(""),this.createDistrictSelect(d),this.data.selectors.district.val(this.data["default"].district_id).trigger("change"),b.debug(d,"onProvinceChangeHandler")},createDistrictSelect:function(a){if(0!==this.data.selectors.district.length){var b=this.data.options.districts.filter(function(b){return b.province_id==a}),c=this.createSelectOptions(b);this.data.selectors.district[0].options.length=0,this.data.selectors.district.append(c)}},onDistrictChangeHandler:function(c){var d=a(c.target).val();this.data.selectors.school.val(""),this.createSchoolSelect(d),this.data.selectors.school.val(this.data["default"].school_id),b.debug(d,"onDistrictChangeHandler")},createSchoolSelect:function(a){if(0!==this.data.selectors.school.length){var b=this;this.ajax("district/"+a+".json").then(function(a){b.data.options.schools=a.data;var c=b.createSelectOptions(a.data.schools);b.data.selectors.school[0].options.length=0,b.data.selectors.school.append(c)})}}};a(document).ready(c)}}});